<div class="header-inner"></div>
<div class="container">
  <ng-container *ngIf="(cart$ | async) as cart">

    <div fxLayout="row" fxLayout.xs="column" fxLayoutAlign="space-between">
      <div fxFlex="75%" fxFlex.xs="100%">
        <app-delivery-loaction></app-delivery-loaction>
      </div>
      <div fxFlex="25%" fxHide.xs="true" fxFlexAlign="center" >
        <section class="right-section"  [matTooltip]="(!terms) ? 'Please accept terms' : ''"
        fxLayout="column" fxLayoutAlign="space-between">
         <div fxFlexAlign="center">
            <!-- <mat-checkbox formControlName="terms"></mat-checkbox> -->
            &nbsp;&nbsp;I agree to the
            <a href="javascript:{}" (click)="triggerTerms()">terms of service</a>
            <br/>
            <br/>
         </div>
         <div fxFlexAlign="center">
          <button class="whatsapp-btn" mat-raised-button color="primary"  type="submit"
          [disabled]="!customerFrm.controls.terms.value">
            <!-- Generator: Adobe Illustrator 25.0.0, SVG Export Plug-In . SVG Version: 6.00 Build 0)  -->
            <svg version="1.1" id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"
                viewBox="0 0 682 682" xml:space="preserve">
            <path class="st0" d="M567.2,113.9C507.3,54,427.8,21,343,21C168.4,21,26.3,163.1,26.2,337.8c0,55.8,14.6,110.3,42.3,158.4
              L23.6,660.4l168-44.1c46.3,25.2,98.4,38.5,151.4,38.6h0.1c174.6,0,316.8-142.1,316.8-316.8C659.9,253.4,627,173.8,567.2,113.9z
                M343,601.4h-0.1c-47.3,0-93.6-12.7-134-36.7l-9.6-5.7l-99.7,26.1l26.6-97.2l-6.3-10C93.6,436,79.7,387.6,79.7,337.8
              C79.8,192.6,197.9,74.5,343.2,74.5c70.3,0,136.5,27.4,186.2,77.2s77.1,115.9,77.1,186.3C606.3,483.2,488.2,601.4,343,601.4z
                M487.5,404.1c-7.9-4-46.8-23.1-54.1-25.8c-7.3-2.6-12.5-4-17.8,4c-5.3,7.9-20.4,25.8-25.1,31c-4.6,5.3-9.2,5.9-17.2,2
              c-7.9-4-33.4-12.3-63.7-39.3c-23.5-21-39.4-46.9-44-54.8c-4.6-7.9,0-11.8,3.5-16.2c8.6-10.6,17.2-21.8,19.8-27.1
              c2.6-5.3,1.3-9.9-0.7-13.9c-2-4-17.8-42.9-24.4-58.8c-6.4-15.4-13-13.3-17.8-13.6c-4.6-0.2-9.9-0.3-15.2-0.3c-5.3,0-13.9,2-21.1,9.9
              c-7.3,7.9-27.7,27.1-27.7,66s28.4,76.6,32.3,81.9c4,5.3,55.8,85.2,135.2,119.5c18.9,8.2,33.6,13,45.1,16.7c19,6,36.2,5.2,49.9,3.1
              c15.2-2.3,46.8-19.2,53.4-37.6c6.6-18.5,6.6-34.3,4.6-37.6C500.7,410.1,495.4,408.1,487.5,404.1z"/>
            </svg>
              Send to Whatsapp </button>
         </div>
        </section>

      </div>
    </div>

  <div *ngIf="!cart || !cart.length">Your cart is empty</div>
  <form [formGroup]="customerFrm" #delivey (ngSubmit)="sendToShop(delivey)">
    <ng-container *ngIf="cart && cart.length">
      <br/>
      <h1 mat-dialog-title>
        My Cart ( {{cart.length}} )
      </h1>
      <div >
        <mat-card *ngFor="let item of cart"
        [ngClass.lt-md]="'grid-my-lt-md-list'"
        [ngClass.gt-md]="'grid-my-gt-md-list'" >
          <div fxLayout="row" fxLayout.xs="column" fxLayoutAlign="space-between">
            <div fxFlex="10%" fxFlex.xs="100%">
              <div class="product-img" [ngStyle]="{'background-image': 'url(' + ((item.product?.shop_product_selected_variant?.shop_product_image?.image) ?  item.product.shop_product_selected_variant.shop_product_image.image_path : 'assets/no-image.jpg') + ')'}">
                <div *ngIf="item.product?.shop_product_selected_variant?.type.id"
                [matTooltip]="(item.product?.shop_product_selected_variant?.type.id == 1) ? 'Veg' : ( (item.product?.shop_product_selected_variant?.type.id == 2) ? 'Non-Veg':'' )"
              [ngClass]="{'veg': item.product?.shop_product_selected_variant?.type.id == 1, 'nonveg': item.product?.shop_product_selected_variant?.type.id == 2}"></div>
              <div fxShow fxHide.gt-xs="true" class="inner-img"></div>
              </div>
            </div>
            <div fxFlex="65%" fxFlex.xs="100%">
              <div class="middle">
                <h4 class="cart-item-header pl-1">
                  <a href="javascript:{}" [routerLink]="'/'+item.product.shop_product_category?.url+'/'+item.product.url"> {{item.product.name}}</a>
                </h4>
                <div fxLayout.xs="row" fxLayout.gt-xs="column" fxLayoutAlign="space-between">
                  <small class="block pl-1">
                    {{item.product.shop_product_selected_variant.name}}
                    {{ item.qty}} {{ (item.qty > 1) ? 'packets': 'packet' }}
                  </small>
                  <b class="block pl-1">₹ {{item.price}}</b>
                </div>


                <div>
                  <small class="block pl-1" *ngIf="item.message"> {{item.message}}</small>
                </div>
                <div [ngClass.xs]="'text-center'">
                  Quantity:
                  <button mat-icon-button color="primary" (click)="updateCart(item, '-')">
                    <mat-icon>remove_circle_outline</mat-icon>
                  </button>
                  {{item.qty}}
                  <button mat-icon-button color="primary" (click)="updateCart(item, '+')">
                    <mat-icon>add_circle_outline</mat-icon>
                  </button>
                </div>
              </div>
            </div>
            <div fxFlex="25%" fxFlex.xs="100%">
              <div fxLayout="row" fxLayoutAlign="center center">
                <button fxFlex.xs="50%" class="itm-block-btn"  mat-flat-button  color="warn" (click)="deleteItem(item)"
                [matTooltip]="'Remove ' +item.product.name+ ' from cart'">
                 <mat-icon>delete</mat-icon> Remove
                </button>
                <button fxFlex.xs="50%" class="itm-block-btn" mat-flat-button  color="primary" (click)="editMessage(item)"
                [matTooltip]="'Add a custom message for '+item.product.name">
                  <mat-icon>add_comment</mat-icon> Custom Message
                </button>
              </div>


            </div>
          </div>

        </mat-card>
      <div class="order-total">
        <mat-card>
          <div fxLayout="row" fxLayout.xs="column" fxLayoutAlign="space-between">
            <div fxFlex="75%" fxFlex.xs="100%">
              You have {{cart.length}}  {{ (cart.length > 1) ? 'items': 'item' }} in your bag
            </div>
            <div fxFlex="75%" fxFlex.xs="100%">
              <small>Total</small>
              <h1>₹  {{ grandTotal }}</h1>
              <small>Inclusive of all taxes</small>
            </div>
          </div>
        </mat-card>

      </div>

      </div>


      <div class="bottom-fixed" fxHide.gt-xs="true">
        <ng-container *ngTemplateOutlet="sayHelloTemplate">
        </ng-container>
      </div>
    </ng-container>
  </form>
</ng-container>
</div>

<ng-template #sayHelloTemplate>
  <p> Say Hello</p>
</ng-template>
